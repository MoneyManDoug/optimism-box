"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.JsonRpcClient = void 0;
const uuid = require("uuid");
const types_1 = require("../../types");
class JsonRpcClient {
    constructor(adapter, client) {
        this.adapter = adapter;
        this.client = client;
    }
    async handle(method, params) {
        const response = await this.makeRpcCall(method, params);
        if (types_1.isJsonRpcErrorResponse(response)) {
            throw new Error(`${JSON.stringify(response.error)}`);
        }
        return response.result;
    }
    async makeRpcCall(method, params) {
        const request = {
            jsonrpc: '2.0',
            method,
            params,
            id: uuid.v4(),
        };
        const encodedRequest = this.adapter.encodeRequest(request);
        const encodedResponse = await this.client.request(encodedRequest);
        return this.adapter.decodeResponse(encodedResponse);
    }
}
exports.JsonRpcClient = JsonRpcClient;
//# sourceMappingURL=json-rpc-client.js.map